<html>
  <head>
    <link rel="stylesheet" href="style.css">
    <style>
      .navbar a.lightrail {
        background-color: DarkOrange;
      }
    </style>
  </head>
  <body>
    <script id="replace_with_navbar" src="nav.js"></script>
    <div class="text1">
      Light Rail Next Train 1.0</br>
      Choose Zone & Stop</br>
    </div>
    <select id="lightrailzone" onchange="zonechange()">
      <option selected="true" disabled="true" value=0>Choose a zone 選擇收費區</option>
      <option value=1>Zone 1 第1收費區</option>
      <option value=2>Zone 2 第2收費區</option>
      <option value=3>Zone 3 第3收費區</option>
      <option value=4>Zone 4 第4收費區</option>
      <option value=5>Zone 5 第5收費區</option>
      <option value=6>Zone 5A 第5A收費區</option>
    </select>
    <select id="lightrailstop" onchange="stopchange()">
      <option disabled="true" value=0>Choose zone first 先選區域</option>
    </select>
    <input type="button" onclick="lookfortrain ()" value="Find">
    <p id="data"></p>
    <script>
      const stn = [
        ["Tuen Mun Ferry Pier 屯門碼頭", "Melody Garden 美樂", "Butterfly 蝴蝶", 
        "Light Rail Depot 輕鐵車廠", "Lung Mun 龍門", "Siu Hei 兆禧",
        "Tuen Mun Swimming Pool 屯門泳池", "Goodview Garden 豐景園", 
        "Siu Lun 兆麟", "Sam Shing 三聖"], 
        [1, 10, 15, 20, 30, 240, 250, 260, 265, 920], 
        ["Zone 2 have not input data"], 
        [40, 50, 60, 70, 75, 80, 170, 180, 190, 200, 212, 220, 230, 270, 275, 280, 295, 300, 
         310, 320, 330], 
        ["Zone 3 have not input data"], 
        [90, 100, 110, 120, 130, 140, 150, 160, 340, 350, 360, 370], 
        ["Zone 4 have not input data"], 
        [380, 390, 400, 425, 430, 435, 445, 448, 450, 455, 460, 490, 500], 
        ["Zone 5 have not input data"], 
        [560, 570, 580, 590, 600], 
        ["Zone 5A have not input data"], 
        [468, 480, 510, 520, 530, 540, 550], 
      ];
      function zonechange() {
        var cont = "<option selected='true' value=0 disabled='true'>Choose a stop 選擇車站</option>";
        for (let i = 0; i < stn[document.getElementById("lightrailzone").value*2-2].length; i++) {
          var cont = cont + "<option value=" + stn[document.getElementById("lightrailzone").value*2-1][i] + ">";
          var cont = cont + stn[document.getElementById("lightrailzone").value*2-2][i] + "</option>";
        }
        document.getElementById("lightrailstop").innerHTML = cont;
      }
      function lookfortrain () {
        var url = "https://rt.data.gov.hk/v1/transport/mtr/lrt/getSchedule?station_id=" + document.getElementById("lightrailstop").value;
        fetch(url).then(response => response.json()).then(function(data){
          if (data["status"] == 0) {
            alert("No Data."); 
          } else {
            var table = "<table><tr><td>Plat</td><td>Rte</td><td>Dest</td><td>Car</td><td>Time</td></tr>";
            for (let i = 0; i < data["platform_list"].length; i++) {
              let plat = i;
              for (let i = 0; i < data["platform_list"][plat]["route_list"].length; i++) {
                var table = table + "<tr><td>" + data["platform_list"][plat]["platform_id"] + 
                  "</td><td>" + data["platform_list"][plat]["route_list"][i]["route_no"] + "</td><td>" + 
                  data["platform_list"][plat]["route_list"][i]["dest_ch"] + " " + 
                  data["platform_list"][plat]["route_list"][i]["dest_en"] + "</td><td>" + 
                  data["platform_list"][plat]["route_list"][i]["train_length"] + "</td><td>" + 
                  data["platform_list"][plat]["route_list"][i]["time_en"] + "</td></tr>";
              }
            }
            document.getElementById("data").innerHTML = table + "</table>";
          }
        });
      }
    </script>
  </body>
</html>
